(()=>{"use strict";var t={165:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Computer=void 0;const r=i(850),s=i(417);class a{constructor(t){this.matrix=[],this.matrixSize=0,this.xValues=[],this.accuracyVectors=[],this.numberOfIterations=0,this.setMatrix(t)}compute(t=a.EPSILON_DEFAULT){const e=r.MatrixValidator.isMatrixValid(this.matrix);if(!e.getStatus())throw new Error(e.getMessage());let i=new s.MatrixConverter(this.matrix,!1);this.matrix=i.prepareMatrix();let n=this.calculateMatrixNorm();if(!(n<1))throw new Error(`Норма матрицы должна быть меньше единицы. Текущая норма: '${n}' ##-Разве это катастрофа?. Итерации не будут сходиться`);return this.calculateXValues(t)}calculateXValues(t){let e,i,r,s;this.xValues=[this.getInitialApproximation()];let a=0;do{a++,this.xValues.push([]);for(let t=0;t<this.matrixSize;t++){s=0,i=t,r=1,e=0;for(let n=1;n<this.matrixSize;n++)n-1==t&&s++,0==i&&(r=0),e+=this.matrix[t][n]*this.xValues[a-1+r][s],s++,i--;e+=this.matrix[t][this.matrixSize],this.xValues[a].push(e)}}while(!this.isAccuracySufficient(t));return this.numberOfIterations=a,console.log("values =",this.xValues),this.xValues}getAccuracy(){if(this.xValues.length<2)throw new Error("Массив приближенных значений иксов содержит только один вектор. Их должно быть минимум два.");let t=this.xValues[this.xValues.length-1],e=this.xValues[this.xValues.length-2];if(t.length!=e.length)throw new Error("Векторы иксов на предпоследней и последней итерациях должны быть равны.");let i=[];for(let r=0;r<t.length;r++)i.push(Math.abs(t[r]-e[r]));return this.accuracyVectors.push(i),Math.max(...i)}isAccuracySufficient(t){return this.getAccuracy()<=t}getInitialApproximation(){let t=[];for(let e of this.matrix)t.push(e[e.length-1]);return t}calculateMatrixNorm(){let t=[],e=0;for(let i=0;i<this.matrixSize;i++){e=0;for(let t=1;t<this.matrixSize;t++)e+=Math.abs(this.matrix[i][t]);t.push(e)}return Math.max(...t)}swapArrayElements(t,e,i){const r=i[t];i[t]=i[e],i[e]=r}getNumberOfIterations(){return this.numberOfIterations}getAccuracyVectors(){return this.accuracyVectors}setMatrix(t){const e=r.MatrixValidator.isMatrixValid(t);if(!e.getStatus())throw new Error(e.getMessage());this.matrix=t,this.matrixSize=t.length}getXVectors(){return console.log("xVectors =",this.xValues),this.xValues}getMatrix(){return this.matrix}}e.Computer=a,a.EPSILON_DEFAULT=.01},417:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MatrixConverter=void 0;const r=i(461),s=i(850);class a{constructor(t,e=a.CHECK_MATRIX_VALIDITY_DEFAULT){this.matrix=[],this.matrixSize=0,this.rowsMap=[],this.setMatrix(t,e)}prepareMatrix(){return this.convert(),this.transform(),this.matrix}convert(){const t=this.isMatrixConvertibleToDominatingDiagonalView();if(!t.getStatus())throw new Error(t.getMessage());let e=0;for(;e<this.rowsMap.length;)e!=this.rowsMap[e]?(this.swapMatrixRows(e,this.rowsMap[e]),this.swapArrayElements(e,this.rowsMap[e],this.rowsMap),e=0):e++;return this.matrix}transform(){for(let t=0;t<this.matrixSize;t++){let e=this.matrix[t][t];for(let i=0;i<this.matrixSize+1;i++)this.matrix[t][i]/=e,t!=i&&i!=this.matrixSize&&(this.matrix[t][i]*=-1),t==i&&this.swapArrayElements(0,i,this.matrix[t])}return this.matrix}isMatrixConvertibleToDominatingDiagonalView(){let t;for(let e=0;e<this.matrixSize;e++){if(t=this.findDominatingElementIndex(this.matrix[e].slice(0,this.matrixSize)),null==t)return new r.Result(!1,`Нет доминирующего элемента в строке номер '${e+1}' (нумерация с 1).`);if(this.rowsMap.indexOf(t)>=0)return new r.Result(!1,`В столбце номер '${t+1}' (нумерация с 1) находится больше одного доминирующего элемента. Невозможно построить матрицу с доминирующей диагональю.`);this.rowsMap[e]=t}return new r.Result(!0,"Матрица может быть преобразована в матрицу с доминирующей диагональю.")}findDominatingElementIndex(t){t.map(((e,i)=>{t[i]=Math.abs(e)}));const e=Math.max(...t),i=t.indexOf(e);let r=0;for(let e=0;e<t.length;e++)e!=i&&(r+=t[e]);return e>=r?i:null}swapMatrixRows(t,e){const i=this.matrix[t];this.matrix[t]=this.matrix[e],this.matrix[e]=i}swapArrayElements(t,e,i){const r=i[t];i[t]=i[e],i[e]=r}setMatrix(t,e){if(e){const e=s.MatrixValidator.isMatrixValid(t);if(!e.getStatus())throw new Error(e.getMessage())}this.matrix=t,this.matrixSize=t.length,this.rowsMap=new Array(this.matrixSize).fill(-1)}getMatrix(){return this.matrix}}e.MatrixConverter=a,a.CHECK_MATRIX_VALIDITY_DEFAULT=!0},850:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MatrixValidator=void 0;const r=i(461);e.MatrixValidator=class{static isMatrixValid(t){return this.isMatrixEmpty(t)?new r.Result(!1,"Матрица не может быть неполной / пустой."):this.isMatrixSquire(t)?this.isMatrixContainsAllZeroRows(t)?new r.Result(!1,"Матрица содержит как минимум одну нулевую строку."):new r.Result(!0,"Матрица правильная."):new r.Result(!1,"Матрица должна быть квадратной.")}static isMatrixEmpty(t){return t.length<2}static isMatrixSquire(t){return 0==t.filter((e=>!(e.length-1==t.length))).length}static isMatrixContainsAllZeroRows(t){for(let e=0;e<t.length;e++)if(0==t[e].filter((t=>0!=t)).length)return!0;return!1}}},461:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Result=void 0,e.Result=class{constructor(t,e){this.status=t,this.message=e}getStatus(){return this.status}getMessage(){return this.message}}}},e={};function i(r){if(e[r])return e[r].exports;var s=e[r]={exports:{}};return t[r](s,s.exports,i),s.exports}(()=>{const t=i(165);let e,r=[[2,2,10,14],[10,1,1,12],[2,10,1,13]],s=new t.Computer(r);const a=document.getElementById("form"),n=document.getElementById("textarea"),l=document.getElementById("filePicker"),o=document.getElementById("submit"),u=document.getElementById("message"),h=document.getElementsByName("radio"),c=document.getElementById("result"),m=document.getElementById("epsilon");if(null==n||null==l||null==o||null==u)throw Error("some element is null");function x(){console.log(".....computing...."),console.log("epsilon: ",e),console.log("Matrix is",r);let t="";try{s.setMatrix(r),s.compute(e),t+=`Искомые значения неизвестных: ${s.getXVectors()[s.getXVectors().length-1].map((t=>"\n"+t))}`,t+=`\n\nКоличество итераций: ${s.getNumberOfIterations()}`,t+=`\n\nВектор погрешностей: ${s.getAccuracyVectors()[s.getAccuracyVectors().length-1].map((t=>"\n"+t))}`,function(t){c.innerHTML=t}(t)}catch(t){M(t)}}function g(t){let e=t.trim().split("\n"),i=[];for(let t of e){i.push([]);for(let e of t.trim().replace(/\s\s+/g," ").split(" ")){if(e.trim(),e=e.replace(",","."),!f(e))return M(`Элемент матрицы не является числом: ${e}`),!1;i[i.length-1].push(Number(e))}}return r=i,!0}function f(t){return null!=t&&""!==t&&!isNaN(Number(t.toString()))}function M(t){u.innerHTML=t}a.addEventListener("input",(t=>{u.innerHTML=""})),o.addEventListener("click",(()=>{c.innerHTML="";let t,i=m.value.toString();if(""!=i.trim())if(f(i))if(e=Number(i),t=!!h[0].checked,t){let t=n.value;if(""==t)return void M("Введите чиселки в поле ввода");g(t)&&x()}else{let t="";if(0!==l.files.length){let e=new FileReader;e.readAsText(l.files[0]),e.onload=()=>{t=e.result,g(t)&&(l.value="",x())}}else M("Выберете файл, пожалуйста")}else M("Введите правильное эпсилон.");else M("Введите эпсилон.")}))})()})();